<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <meta
      content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"
      name="viewport"
    />

    <!-- 引入样式 -->
    <link rel="stylesheet" href="../plugins/elementui/index.css" />
    <link
      rel="stylesheet"
      href="../plugins/font-awesome/css/font-awesome.min.css"
    />
    <link rel="stylesheet" href="../css/style.css" />
  </head>
  <body>
    <div id="app">
        <template>
            <div class="admin-manage">
              <h1>管理员管理页面</h1>
              <el-tabs v-model="activeTab" type="border-card">
                <el-tab-pane label="教师管理" name="teacher">
                  <el-form :model="teacherForm" ref="teacherForm" label-width="80px" style="margin-top: 20px;">
                    <el-form-item label="教师编号">
                      <el-input v-model="teacherForm.teacherNo" placeholder="请输入教师编号" style="width: 200px"></el-input>
                    </el-form-item>
                    <el-form-item label="教师姓名">
                      <el-input v-model="teacherForm.teacherName" placeholder="请输入教师姓名" style="width: 200px"></el-input>
                    </el-form-item>
                    <el-form-item label="学院编号">
                      <el-input v-model="teacherForm.instituteNo" placeholder="请输入学院编号" style="width: 200px"></el-input>
                    </el-form-item>
                    <el-form-item>
                      <el-button type="primary" @click="submitTeacherForm">提交</el-button>
                    </el-form-item>
                  </el-form>
                  <el-table size="small" current-row-key="id" stripe highlight-current-row :data="teacherList" style="margin-top: 20px;">
                    <el-table-column prop="teacherNo" label="编号"></el-table-column>
                    <el-table-column prop="teacherName" label="姓名"></el-table-column>
                    <el-table-column prop="instituteNo" label="学院编号"></el-table-column>
                    <el-table-column label="操作">
                      <template slot-scope="scope">
                        <el-button type="primary" size="mini" @click="UpdateTeacher(scope.row)">编辑</el-button>
                        <el-button type="danger" size="mini" @click="deleteTeacher(scope.row)">删除</el-button>
                      </template>
                    </el-table-column>
                  </el-table>
                </el-tab-pane>
                <el-tab-pane label="学生管理" name="student">
                  <el-form :model="studentForm" ref="studentForm" label-width="80px" style="margin-top: 20px;">
                    <el-form-item label="学生编号">
                      <el-input v-model="studentForm.studentNo" placeholder="请输入学生编号" style="width: 200px"></el-input>
                    </el-form-item>
                    <el-form-item label="学生姓名">
                      <el-input v-model="studentForm.studentName" placeholder="请输入学生姓名" style="width: 200px"></el-input>
                    </el-form-item>
                    <el-form-item label="班级号">
                      <el-input v-model="studentForm.classNo" placeholder="请输入学生班级号" style="width: 200px"></el-input>
                    </el-form-item>
                    <el-form-item>
                      <el-button type="primary" @click="submitStudentForm">提交</el-button>
                    </el-form-item>
                  </el-form>
                  <el-table :data="studentList" style="margin-top: 20px;">
                    <el-table-column prop="studentNo" label="学号"></el-table-column>
                    <el-table-column prop="studentName" label="姓名"></el-table-column>
                    <el-table-column prop="classNo" label="班级号"></el-table-column>
                    <el-table-column label="操作">
                      <template slot-scope="scope">
                        <el-button type="danger" size="mini" @click="deleteStudent(scope.row)">删除</el-button>
                      </template>
                    </el-table-column>
                  </el-table>
                </el-tab-pane>
              </el-tabs>
            </div>
          </template>

    </div>

    <!-- 引入组件库 -->
    <script src="../js/vue.js"></script>
    <script src="../plugins/elementui/index.js"></script>
    <script type="text/javascript" src="../js/jquery.min.js"></script>
    <script src="../js/axios-0.18.0.js"></script>
    <script>
      new Vue({
        el: "#app",

        data:{
          //return {
            activeTab: 'teacher',
            teacherForm: {
              // teacherNo: '',
              // teacherName: '',
              // instituteNo: '',
              // password: '123456'
            },
            studentForm: {
              // studentNo: '',
              // studentName: '',
              // classNo: '',
              // password: '123456'
            },
            teacherList: [
              // 填充教师列表数据
            ],
            studentList: [
              // 填充学生列表数据
            ]
          //}
          },

          created() {
            this.getTeacherList();
          },
          methods: {
            submitTeacherForm() {
              // 提交教师信息
              // 发送 POST 请求保存教师信息到服务器
              // 成功后清空表单并重新获取教师列表
              this.$refs.teacherForm.validate(valid => {
                if (valid) {
                  axios.post('/teacher', this.teacherForm)
                    .then(response => {
                      this.$message.success('教师信息保存成功')
                      this.getTeacherList()
                    })
                    .catch(error => {
                      this.$message.error('教师信息保存失败')
                    })
                }
              })
            },

            // 完成
            deleteTeacher(row) {
              // 删除教师信息
              // 发送 DELETE 请求删除教师信息
              // 成功后重新获取教师列表
              this.$confirm("此操作永久删除当前数据，是否继续？","提示",{
                type:'info'
              }).then(()=>{
                axios.delete(`/teacher/` + row.teacherNo)
                        .then(response => {
                          this.$message.success('教师信息删除成功')
                          this.getTeacherList()
                        })
              }).catch(error => {
                    this.$message.error('教师信息删除失败')
                  })
            },

            submitStudentForm() {
              // 提交学生信息
              // 发送 POST 请求保存学生信息到服务器
              // 成功后清空表单并重新获取学生列表
              this.$refs.studentForm.validate(valid => {
                if (valid) {
                  axios.post('/student', this.studentForm)
                    .then(response => {
                      this.$message.success('学生信息保存成功')
                      // this.studentForm = {
                      //   // id: '',
                      //   // name: '',
                      //   // email: '',
                      //   // password: ''
                      // }
                      this.getStudentList()
                    })
                    .catch(error => {
                      this.$message.error('学生信息保存失败')
                    })
                }
              })
            },

            deleteStudent(row) {
              // 删除学生信息
              // 发送 DELETE 请求删除学生信息
              // 成功后重新获取学生列表
              this.$confirm("此操作永久删除当前数据，是否继续？","提示",{
                type:'info'
              }).then(()=>{
                axios.delete(`/student/` + row.studentNo)
                        .then(response => {
                          this.$message.success('学生信息信息删除成功')
                          this.getStudentList()
                        })
              }).catch(error => {
                this.$message.error('学生信息删除失败')
              })
            },

            // 完成
            getTeacherList() {
              // 获取教师列表
              // 发送 GET 请求获取教师列表数据，并更新到 teacherList 变量中
              axios.get('/teacher')
                .then(response => {
                  this.teacherList = response.data
                })
                .catch(error => {
                  console.log(error)
                })
            },

            // 完成
            getStudentList() {
              // 获取学生列表
              // 发送 GET 请求获取学生列表数据，并更新到 studentList 变量中
              axios.get('/student')
                .then(response => {
                  this.studentList = response.data
                })
                .catch(error => {
                  console.log(error)
                })
            }
          },
          mounted() {
            // 组件挂载时获取教师列表和学生列表数据
            this.getTeacherList()
            this.getStudentList()
          }
      });
    </script>
  </body>
</html>
